{
	"name": "Create Gold Views",
	"properties": {
		"content": {
			"query": "-- viweing column names in ball_by_ball\nSELECT\n    COLUMN_NAME,\n    DATA_TYPE\nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE TABLE_SCHEMA = 'gold'\n  AND TABLE_NAME = 'ball_by_ball'\nORDER BY ORDINAL_POSITION;\n\n---- Aggregates ball-by-ball data to find total runs scored by each player per season\nCREATE OR ALTER VIEW gold.top_scoring_batsmen_per_season AS\nSELECT\n    p.player_name,\n    m.season_year,\n    SUM(b.runs_scored) AS total_runs\nFROM gold.ball_by_ball b\nJOIN gold.match m\n    ON b.match_id = m.match_id\nJOIN gold.player_match pm\n    ON m.match_id = pm.match_id\n   AND b.striker = pm.player_id\nJOIN gold.player p\n    ON p.player_id = pm.player_id\nGROUP BY\n    p.player_name,\n    m.season_year;\n\n-- Analyzes powerplay bowling performance by country based on economy and wickets\nSELECT\n    p.country_name,\n    p.player_name,\n    AVG(b.runs_scored) AS avg_runs_per_ball,\n    SUM(CASE WHEN b.bowler_wicket = 1 THEN 1 ELSE 0 END) AS total_wickets\nFROM gold.ball_by_ball b\nJOIN gold.player_match pm\n    ON b.match_id = pm.match_id\n   AND b.bowler = pm.player_id\nJOIN gold.player p\n    ON pm.player_id = p.player_id\nWHERE b.over_id <= 6\nGROUP BY\n    p.country_name,\n    p.player_name\nORDER BY\n    avg_runs_per_ball ASC,\n    total_wickets DESC;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "iplanalysis",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}