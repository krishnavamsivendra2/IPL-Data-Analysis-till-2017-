{
	"name": "Creating External tables",
	"properties": {
		"content": {
			"query": "CREATE MASTER KEY ENCRYPTION BY PASSWORD ='<password>' \n\nCREATE DATABASE SCOPED CREDENTIAL <credential_name>\nWITH IDENTITY = 'identity_name'\n\nCREATE EXTERNAL DATA SOURCE gold_dest\nWITH(\n    LOCATION = 'https://iplanalysis.dfs.core.windows.net/gold',\n    CREDENTIAL = <credential_name>\n)\n\nCREATE EXTERNAL FILE FORMAT gold_format\nWITH(\n    FORMAT_TYPE = PARQUET,\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec'\n);\n\n--1️⃣ gold.top_scoring_batsmen_per_season\nCREATE EXTERNAL TABLE gold_ext.top_scoring_batsmen_per_season\nWITH (\n    LOCATION = 'top_scoring_batsmen_per_season/',\n    DATA_SOURCE = gold_dest,\n    FILE_FORMAT = gold_format\n)\nAS\nSELECT *\nFROM gold.top_scoring_batsmen_per_season;\n\n--2️⃣ gold.economic_bowler\nCREATE EXTERNAL TABLE gold_ext.economic_bowler\nWITH (\n    LOCATION = 'economic_bowler/',\n    DATA_SOURCE = gold_dest,\n    FILE_FORMAT = gold_format\n)\nAS\nSELECT *\nFROM gold.economic_bowler;\n\n--3️⃣ gold.result_based_on_toss\nCREATE EXTERNAL TABLE gold_ext.result_based_on_toss\nWITH (\n    LOCATION = 'result_based_on_toss/',\n    DATA_SOURCE = gold_dest,\n    FILE_FORMAT = gold_format\n)\nAS\nSELECT *\nFROM gold.result_based_on_toss;\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "iplanalysis",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}